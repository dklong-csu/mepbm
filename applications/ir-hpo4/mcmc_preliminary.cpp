#include "sample.h"
#include <iostream>
#include "nvector_eigen.h"
#include <eigen3/Eigen/Sparse>
#include "sampling_algorithm.h"
#include <string>
#include "data.h"
#include "models.h"
#include <vector>



using Real = realtype;
using Matrix = Eigen::SparseMatrix<realtype, Eigen::RowMajor>;
using Vector = Eigen::Matrix<realtype, Eigen::Dynamic, 1>;



class HPO4Nucleation : public Model::RightHandSideContribution<Real, Matrix>
{
public:
  const unsigned int A_index, As_index, ligand_index, particle_index, A_half_index;
  const Real rate_forward, rate_backward, rate_nucleation;
  const Real solvent;

  /// Constructor -- creates an invalid object by default
  HPO4Nucleation();

  /// Constructor
  HPO4Nucleation(unsigned int A_index, unsigned int As_index, unsigned int ligand_index,
                         unsigned int particle_index, unsigned int A_half_index,
                         Real rate_forward, Real rate_backward, Real rate_nucleation,
                         Real solvent);

  void add_contribution_to_rhs(const Eigen::Matrix<Real, Eigen::Dynamic, 1> &x,
                               Eigen::Matrix<Real, Eigen::Dynamic, 1> &rhs) override;

  void add_contribution_to_jacobian(const Eigen::Matrix<Real, Eigen::Dynamic, 1> &x,
                                    Matrix &J) override;

  void add_nonzero_to_jacobian(std::vector<Eigen::Triplet<Real>> &triplet_list) override;

  void update_num_nonzero(unsigned int &num_nonzero) override;
};



HPO4Nucleation::HPO4Nucleation(unsigned int A_index, unsigned int As_index, unsigned int ligand_index,
                               unsigned int particle_index, unsigned int A_half_index,
                               Real rate_forward, Real rate_backward, Real rate_nucleation,
                               Real solvent)
  : A_index(A_index)
  , As_index(As_index)
  , ligand_index(ligand_index)
  , particle_index(particle_index)
  , A_half_index(A_half_index)
  , rate_forward(rate_forward)
  , rate_backward(rate_backward)
  , rate_nucleation(rate_nucleation)
  , solvent(solvent)
{}



HPO4Nucleation::HPO4Nucleation()
  : HPO4Nucleation(std::numeric_limits<unsigned int>::signaling_NaN(),
                   std::numeric_limits<unsigned int>::signaling_NaN(),
                   std::numeric_limits<unsigned int>::signaling_NaN(),
                   std::numeric_limits<unsigned int>::signaling_NaN(),
                   std::numeric_limits<unsigned int>::signaling_NaN(),
                   std::numeric_limits<Real>::signaling_NaN(),
                   std::numeric_limits<Real>::signaling_NaN(),
                   std::numeric_limits<Real>::signaling_NaN(),
                   std::numeric_limits<Real>::signaling_NaN())
{}


void HPO4Nucleation::add_contribution_to_rhs(const Eigen::Matrix<Real, Eigen::Dynamic, 1> &x,
                                             Eigen::Matrix<Real, Eigen::Dynamic, 1> &rhs)
{
  rhs(A_index) += -rate_forward * 2 * x(A_index) * solvent * solvent
                  + rate_backward * x(As_index) * x(ligand_index) * x(A_half_index);

  rhs(As_index) += rate_forward * x(A_index) * solvent * solvent
                   - rate_backward * x(As_index) * x(ligand_index) * x(A_half_index)
                   - rate_nucleation * x(As_index);

  rhs(ligand_index) += rate_forward * x(A_index) * solvent * solvent
                       - rate_backward * x(As_index) * x(ligand_index) * x(A_half_index);

  rhs(A_half_index) += rate_forward * x(A_index) * solvent * solvent
                       - rate_backward * x(As_index) * x(ligand_index) * x(A_half_index);

  rhs(particle_index) += rate_nucleation * x(As_index);
}


void HPO4Nucleation::add_contribution_to_jacobian(const Eigen::Matrix<Real, Eigen::Dynamic, 1> &x, Matrix &J)
{
  J.coeffRef(A_index, A_index) += -2 * rate_forward * solvent * solvent;
  J.coeffRef(A_index, As_index) += rate_backward * x(ligand_index) * x(A_half_index);
  J.coeffRef(A_index, ligand_index) += rate_backward * x(As_index) * x(A_half_index);
  J.coeffRef(A_index, A_half_index) += rate_backward * x(As_index) * x(ligand_index);

  J.coeffRef(As_index, A_index) += 2 * rate_forward * solvent * solvent;
  J.coeffRef(As_index, As_index) += -rate_backward * x(ligand_index) * x(A_half_index)
                                    -rate_nucleation;
  J.coeffRef(As_index, ligand_index) += -rate_backward * x(As_index) * x(A_half_index);
  J.coeffRef(As_index, A_half_index) += -rate_backward * x(As_index) * x(ligand_index);

  J.coeffRef(ligand_index, A_index) += 2 *rate_forward * solvent * solvent;
  J.coeffRef(ligand_index, As_index) += -rate_backward * x(ligand_index) * x(A_half_index);
  J.coeffRef(ligand_index, ligand_index) += -rate_backward * x(As_index) * x(A_half_index);
  J.coeffRef(ligand_index, A_half_index) += -rate_backward * x(As_index) * x(ligand_index);

  J.coeffRef(A_half_index, A_index) += 2 * rate_forward * solvent * solvent;
  J.coeffRef(A_half_index, As_index) += -rate_backward * x(ligand_index) * x(A_half_index);
  J.coeffRef(A_half_index, ligand_index) += -rate_backward * x(As_index) * x(A_half_index);
  J.coeffRef(A_half_index, A_half_index) += -rate_backward * x(As_index) * x(ligand_index);

  J.coeffRef(particle_index, As_index) += rate_nucleation;
}


void HPO4Nucleation::add_nonzero_to_jacobian(std::vector<Eigen::Triplet<Real>> &triplet_list)
{
  triplet_list.push_back(Eigen::Triplet<Real>(A_index, A_index));
  triplet_list.push_back(Eigen::Triplet<Real>(A_index, As_index));
  triplet_list.push_back(Eigen::Triplet<Real>(A_index, ligand_index));
  triplet_list.push_back(Eigen::Triplet<Real>(A_index, A_half_index));

  triplet_list.push_back(Eigen::Triplet<Real>(As_index, A_index));
  triplet_list.push_back(Eigen::Triplet<Real>(As_index, As_index));
  triplet_list.push_back(Eigen::Triplet<Real>(As_index, ligand_index));
  triplet_list.push_back(Eigen::Triplet<Real>(As_index, A_half_index));

  triplet_list.push_back(Eigen::Triplet<Real>(ligand_index, A_index));
  triplet_list.push_back(Eigen::Triplet<Real>(ligand_index, As_index));
  triplet_list.push_back(Eigen::Triplet<Real>(ligand_index, ligand_index));
  triplet_list.push_back(Eigen::Triplet<Real>(ligand_index, A_half_index));

  triplet_list.push_back(Eigen::Triplet<Real>(A_half_index, A_index));
  triplet_list.push_back(Eigen::Triplet<Real>(A_half_index, As_index));
  triplet_list.push_back(Eigen::Triplet<Real>(A_half_index, ligand_index));
  triplet_list.push_back(Eigen::Triplet<Real>(A_half_index, A_half_index));

  triplet_list.push_back(Eigen::Triplet<Real>(particle_index, As_index));
}


void HPO4Nucleation::update_num_nonzero(unsigned int &num_nonzero)
{
  num_nonzero += 17;
}



Model::Model<Real, Matrix>
four_step(const std::vector<Real> real_prm,
          const std::vector<int> int_prm)
{
  // Order of vector is
  // { A, As, ligand, A_half, particle 1, particle 2, ... }, so indexes are ->
  // { 0, 1 , 2     , 3     , 4         , 5         , ...}
  std::shared_ptr<Model::RightHandSideContribution<Real, Matrix>> nucleation =
      std::make_shared<HPO4Nucleation>(0,
                                       1,
                                       2,
                                       4,
                                       3,
                                       real_prm[0],
                                       real_prm[1],
                                       real_prm[2],
                                       11.7);

  // Convert from cutoff to particle size --> M=1->particle size 1, M=2->particle size 3, etc
  std::shared_ptr<Model::RightHandSideContribution<Real, Matrix>> small_growth =
      std::make_shared<Model::Growth<Real, Matrix>>(0,
                                                        1,
                                                        2*int_prm[0]-1,
                                                        801,
                                                     2,
                                                     2,
                                                     real_prm[3],
                                                     4);

  const unsigned int m_index = (2*int_prm[0]-2)/2 + 4;
  std::shared_ptr<Model::RightHandSideContribution<Real, Matrix>> large_growth =
      std::make_shared<Model::Growth<Real, Matrix>>(0,
                                              2*(int_prm[0]+1)-1,
                                                         801,
                                                         801,
                                                         2,
                                                         2,
                                                         real_prm[4],
                                                         m_index+1);

  std::shared_ptr<Model::RightHandSideContribution<Real, Matrix>> agglomeration
      = std::make_shared<Model::Agglomeration<Real, Matrix>>(1, 2*int_prm[0]-1,
                                                             1, 2*int_prm[0]-1,
                                                             801, 2,
                                                             real_prm[5], 4);

  Model::Model<Real, Matrix> m(1,801);
  m.add_rhs_contribution(nucleation);
  m.add_rhs_contribution(small_growth);
  m.add_rhs_contribution(large_growth);
  m.add_rhs_contribution(agglomeration);
  return m;
}



int main (int argc, char **argv)
{
  unsigned int n_threads = 1;
  #ifdef _OPENMP
    n_threads = omp_get_max_threads();
  #endif

#pragma omp parallel for
    for (unsigned int thread=0; thread<n_threads; ++thread) {
      // create a sample
      std::vector<Real> real_prm = {6e-3, 6e-3 / 5e-5, 1e5, 1e5, 1e4, 1e2};
      std::vector<int> int_prm = {50};

      std::vector<std::pair<Real, Real> > real_prm_bounds =
          {
              {0, 1e8},
              {0, 1e8},
              {0, 1e8},
              {0, 1e8},
              {0, 1e8},
              {0, 1e8}
          };


      std::vector<std::pair<int, int> > int_prm_bounds =
          {
              {5, 400}
          };

      std::function<Model::Model<Real, Matrix>(const std::vector<Real>, const std::vector<int>)> create_model_fcn
          = four_step;

      // Calculate the number of dimensions
      // A + As + HPO4 + A half + size 1 + size 3 + ... + size 801
      const unsigned int n_vars = 4 + ((801 - 1) / 2 + 1);
      N_Vector initial_condition = create_eigen_nvector<Vector>(n_vars);
      auto ic_vec = static_cast<Vector *>(initial_condition->content);
      for (unsigned int i = 0; i < ic_vec->size(); ++i) {
        if (i == 0)
          (*ic_vec)(i) = 0.0625;
        else
          (*ic_vec)(i) = 0.;
      }
      Real start_time = 0;
      Real end_time = 10.0;
      Real abs_tol = 1e-13;
      Real rel_tol = 1e-6;

      Data::PomData<Real> data;
      std::vector<Real> times = {1.5, 3.25, 5.0, 10.0};

      std::vector<Real> data_set1 = {0.50,
                                     0.50,
                                     0.50,
                                     0.51,
                                     0.51,
                                     0.51,
                                     0.51,
                                     0.51,
                                     0.51,
                                     0.51,
                                     0.51,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.52,
                                     0.53,
                                     0.53,
                                     0.53,
                                     0.53,
                                     0.53,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.54,
                                     0.55,
                                     0.55,
                                     0.55,
                                     0.55,
                                     0.55,
                                     0.56,
                                     0.56,
                                     0.56,
                                     0.56,
                                     0.56,
                                     0.56,
                                     0.57,
                                     0.57,
                                     0.57,
                                     0.57,
                                     0.57,
                                     0.57,
                                     0.57,
                                     0.58,
                                     0.58,
                                     0.58,
                                     0.58,
                                     0.58,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.59,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.60,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.61,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.62,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.63,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.64,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.65,
                                     0.66,
                                     0.66,
                                     0.66,
                                     0.66,
                                     0.66,
                                     0.66,
                                     0.66,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.67,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.71,
                                     0.71,
                                     0.71,
                                     0.71,
                                     0.71,
                                     0.71,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.74,
                                     0.74,
                                     0.74,
                                     0.74,
                                     0.74,
                                     0.74,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.79,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.94,
                                     0.94,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.99,
                                     0.99,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.22,
                                     1.22,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.27,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.33,
                                     1.33,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.36,
                                     1.37,
                                     1.37,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.40,
                                     1.40,
                                     1.41,
                                     1.41,
                                     1.42,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.47,
                                     1.48,
                                     1.48,
                                     1.49,
                                     1.50,
                                     1.50,
                                     1.51,
                                     1.51,
                                     1.52,
                                     1.52,
                                     1.53,
                                     1.53,
                                     1.54,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.58,
                                     1.58,
                                     1.59,
                                     1.60,
                                     1.60,
                                     1.61,
                                     1.63,
                                     1.75,
                                     1.86,
                                     1.88};

      std::vector<Real> data_set2 = {0.54,
                                     0.56,
                                     0.57,
                                     0.57,
                                     0.57,
                                     0.58,
                                     0.60,
                                     0.62,
                                     0.63,
                                     0.64,
                                     0.64,
                                     0.66,
                                     0.66,
                                     0.67,
                                     0.68,
                                     0.68,
                                     0.68,
                                     0.69,
                                     0.69,
                                     0.69,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.70,
                                     0.71,
                                     0.71,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.73,
                                     0.74,
                                     0.74,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.75,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.76,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.77,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.78,
                                     0.79,
                                     0.79,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.80,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.81,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.82,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.83,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.86,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.87,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.88,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.89,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     0.99,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.45,
                                     1.45,
                                     1.46,
                                     1.46,
                                     1.46,
                                     1.47,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.49,
                                     1.50,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.53,
                                     1.53,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.55,
                                     1.55,
                                     1.56,
                                     1.57,
                                     1.58,
                                     1.59,
                                     1.61,
                                     1.62,
                                     1.62,
                                     1.63,
                                     1.63,
                                     1.65,
                                     1.66,
                                     1.79,
                                     1.84};

      std::vector<Real> data_set3 = {0.72,
                                     0.72,
                                     0.72,
                                     0.72,
                                     0.73,
                                     0.76,
                                     0.77,
                                     0.80,
                                     0.80,
                                     0.82,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.84,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.85,
                                     0.86,
                                     0.87,
                                     0.87,
                                     0.88,
                                     0.88,
                                     0.89,
                                     0.89,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.90,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.91,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.92,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.93,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.94,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.95,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.96,
                                     0.97,
                                     0.97,
                                     0.97,
                                     0.98,
                                     0.98,
                                     0.98,
                                     0.99,
                                     0.99,
                                     0.99,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.00,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.01,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.03,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.04,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.06,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.07,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.08,
                                     1.09,
                                     1.09,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.11,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.13,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.14,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.17,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.24,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.45,
                                     1.45,
                                     1.45,
                                     1.45,
                                     1.46,
                                     1.46,
                                     1.46,
                                     1.46,
                                     1.47,
                                     1.47,
                                     1.47,
                                     1.47,
                                     1.47,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.50,
                                     1.50,
                                     1.50,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.52,
                                     1.53,
                                     1.53,
                                     1.53,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.57,
                                     1.58,
                                     1.58,
                                     1.59,
                                     1.61,
                                     1.61,
                                     1.62,
                                     1.62,
                                     1.62,
                                     1.62,
                                     1.63,
                                     1.64,
                                     1.65,
                                     1.65,
                                     1.66,
                                     1.67,
                                     1.67,
                                     1.68,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.72,
                                     1.74,
                                     1.77,
                                     1.83};

      std::vector<Real> data_set4 = {0.80,
                                     0.93,
                                     0.93,
                                     0.97,
                                     0.99,
                                     1.00,
                                     1.01,
                                     1.02,
                                     1.02,
                                     1.02,
                                     1.03,
                                     1.03,
                                     1.05,
                                     1.05,
                                     1.05,
                                     1.07,
                                     1.07,
                                     1.08,
                                     1.08,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.09,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.10,
                                     1.11,
                                     1.12,
                                     1.12,
                                     1.12,
                                     1.13,
                                     1.13,
                                     1.14,
                                     1.14,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.15,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.16,
                                     1.17,
                                     1.17,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.18,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.19,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.20,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.21,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.22,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.23,
                                     1.24,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.25,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.26,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.27,
                                     1.28,
                                     1.28,
                                     1.28,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.29,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.30,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.31,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.32,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.33,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.34,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.35,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.36,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.37,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.38,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.39,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.40,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.41,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.42,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.43,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.44,
                                     1.45,
                                     1.45,
                                     1.45,
                                     1.45,
                                     1.45,
                                     1.45,
                                     1.46,
                                     1.46,
                                     1.46,
                                     1.46,
                                     1.46,
                                     1.47,
                                     1.47,
                                     1.47,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.48,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.49,
                                     1.50,
                                     1.50,
                                     1.50,
                                     1.50,
                                     1.50,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.51,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.52,
                                     1.53,
                                     1.53,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.54,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.55,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.56,
                                     1.57,
                                     1.57,
                                     1.57,
                                     1.57,
                                     1.57,
                                     1.57,
                                     1.57,
                                     1.58,
                                     1.58,
                                     1.58,
                                     1.59,
                                     1.59,
                                     1.59,
                                     1.59,
                                     1.59,
                                     1.59,
                                     1.59,
                                     1.60,
                                     1.60,
                                     1.60,
                                     1.60,
                                     1.60,
                                     1.60,
                                     1.61,
                                     1.61,
                                     1.61,
                                     1.61,
                                     1.61,
                                     1.62,
                                     1.62,
                                     1.62,
                                     1.62,
                                     1.63,
                                     1.63,
                                     1.63,
                                     1.63,
                                     1.64,
                                     1.64,
                                     1.64,
                                     1.64,
                                     1.64,
                                     1.64,
                                     1.65,
                                     1.65,
                                     1.65,
                                     1.65,
                                     1.65,
                                     1.65,
                                     1.66,
                                     1.66,
                                     1.66,
                                     1.66,
                                     1.67,
                                     1.67,
                                     1.67,
                                     1.67,
                                     1.67,
                                     1.67,
                                     1.68,
                                     1.68,
                                     1.68,
                                     1.68,
                                     1.69,
                                     1.69,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.70,
                                     1.71,
                                     1.71,
                                     1.71,
                                     1.71,
                                     1.71,
                                     1.72,
                                     1.72,
                                     1.73,
                                     1.73,
                                     1.73,
                                     1.73,
                                     1.74,
                                     1.74,
                                     1.74,
                                     1.75,
                                     1.75,
                                     1.75,
                                     1.76,
                                     1.76,
                                     1.77,
                                     1.77,
                                     1.78,
                                     1.78,
                                     1.78,
                                     1.79,
                                     1.80,
                                     1.81,
                                     1.82,
                                     1.82,
                                     1.82,
                                     1.84,
                                     1.85,
                                     1.85,
                                     1.89,
                                     1.89,
                                     1.90,
                                     1.90,
                                     1.95};

      unsigned int first_particle_index = 4;
      unsigned int last_particle_index = n_vars - 1;

      Histograms::Parameters<Real> binning_parameters(24, 0.4, 2.8);
      unsigned int first_particle_size = 1;
      unsigned int particle_size_increase = 2;
      std::vector<std::vector<Real> > data_sets = {data_set1, data_set2, data_set3, data_set4};

      Sampling::ModelingParameters<Real, Matrix> model_settings(real_prm_bounds,
                                                                int_prm_bounds,
                                                                create_model_fcn,
                                                                initial_condition,
                                                                start_time,
                                                                end_time,
                                                                abs_tol,
                                                                rel_tol,
                                                                times,
                                                                first_particle_index,
                                                                last_particle_index,
                                                                binning_parameters,
                                                                first_particle_size,
                                                                particle_size_increase,
                                                                data_sets);

      Sampling::Sample<Real> sample1(real_prm, int_prm);


      // Create the sampler
      const std::vector<Real> perturb_mag_real = {0.001, 3e2, 3e3, 3e3, 5e2, 5};
      const std::vector<int> perturb_mag_int = {10};
      Sampling::Sampler<Real, Matrix, Sampling::UniformProposal, Sampling::UniformPrior, Sampling::DataTEMOnly>
          sampler(sample1, perturb_mag_real, perturb_mag_int, model_settings);

      // Create a seed for the random number generator to ensure consistent results.
      const std::uint_fast32_t random_seed
        = (argc > 1 ?
           std::hash<std::string>()(std::to_string(atoi(argv[1]) + thread)) :
           std::hash<std::string>()(std::to_string(thread)));

      // Create an output file to print all of the samples.
      std::ofstream samples_file("samples"
                                  +
                                   (argc > 1 ?
                                   std::string(".") + std::to_string(atoi(argv[1]) + thread) :
                                   std::string(".") + std::to_string(thread))
                                   +
                                   ".txt");
      sampler.generate_samples(1000, samples_file, random_seed);
    }
}